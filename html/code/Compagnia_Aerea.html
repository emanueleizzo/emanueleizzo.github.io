<div class="mb-3 border-0">
    <h1 id="1">1) Introduzione</h1>
    <div class="my-3">
        Poniamo di avere questa situazione davanti: siamo al gate, in attesa di poter imbarcare sul nostro volo, siamo
        lì tranquilli a leggere il nostro amato libro oppure ad ascoltare quella playlist infinita che avevamo preparato
        in anticipo, quando la nostra attenzione viene catturata da altri passeggeri in attesa che commentano alcune
        recensioni di una compagnia aerea:
        <div class="my-3 mx-5">
            <div class="row m-0 p-0 justify-content-end">
                <div class="col-5 p-2 bubble-text-right">Stavo vedendo vedendo alcune recensioni di questa compagnia
                    aerea. Secondo alcuni il servizio Wi-Fi è come inesistente.</div>
            </div>
            <div class="row m-0 p-0 justify-content-start">
                <div class="col-5 p-2 bubble-text-left">Davvero? Eppure qui dicono che i servizi a bordo siano veramente
                    buoni, seppur hanno avuto un problema con un ritardo alla partenza.</div>
            </div>
            <div class="row m-0 p-0 justify-content-end">
                <div class="col-5 p-2 bubble-text-right">Vedo, però quella recensione è abbastanza vecchia. C'è questa
                    qui invece in cui viene pesantemente cricitaco il cibo, definendolo "freddo e insipido".</div>
            </div>
            <div class="row m-0 p-0 justify-content-start">
                <div class="col-5 p-2 bubble-text-left">Ok, ci sta; però sembrerebbe che la persona che ha lasciato la
                    recensione abbia viaggiato solo una volta con la compagnia.</div>
            </div>
            <div class="row m-0 p-0 justify-content-end">
                <div class="col-5 p-2 bubble-text-right">Davvero?</div>
            </div>
            <div class="row m-0 p-0 justify-content-start">
                <div class="col-5 p-2 bubble-text-left">Sì, anzi, c'è questo utente che viaggia spesso con la compagnia
                    che ha trovato sempre il cibo a bordo delizioso.</div>
            </div>
        </div>
        Ascoltando i loro discorsi iniziamo a ragionare sulla questione: nella maggior parte dei casi una valutazione
        della qualità di un servizio si basa sull'analisi e la combinazione di vari fattori e servizi. A questo punto
        però la domanda viene spontanea:
        <h4 class="m-3">Cos'è che potrebbe avere maggiore influenza nella valutazione della qualità del servizio di una
            compagnia aerea?</h4>
        Questa domanda non so ci permette di capire quali sono gli aspettim principali che una compagnia aerea deve
        osservare per migliorare il proprio servizio, ma ci permette anche di rispondere ad un ulteriore domanda, ossia:
        <h4 class="m-3">È possibile realizzare un sistema di machine learning in grado di predirre la soddisfazione o no
            di un passeggero?</h4>
    </div>
</div>

<div class="mb-3 border-0">
    <h1 id="2">2) Librerie utilizzate</h1>
    <div class="my-3">
        Prima di partire con una qualsiasi analisi dei dati partiamo dall'importare tutte le librerie necessarie per
        lavorare:
        <pre class="line-numbers"><code class="language-python">import matplotlib.pyplot as plt
import seaborn as sns

import pandas as pd
pd.set_option('display.max_colwidth', None)

import numpy as np

import torch
import torch.nn as nn
import torch.nn.functional as F

from torchvision import datasets
import torchvision.transforms as transforms

from sklearn.decomposition import PCA
from sklearn.neighbors import KNeighborsClassifier
from sklearn.svm import SVC
from sklearn.metrics import accuracy_score, precision_score, recall_score, f1_score</code></pre>
    </div>
</div>

<div class="mb-3 border-0">
    <h1 id="3">3) Analisi dei dati</h1>
    <div class="my-3">
        Partiamo in primis da un'analisi dei dati a nostra disposizione; per ogni passeggero che ha viaggiato con la
        nostra compagnia aerea vengono registrate varie informazioni:
        <div class="my-3">
            <table class="table">
                <thead>
                    <tr>
                        <td>Campo</td>
                        <td>Valori</td>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Sesso</td>
                        <td><code class="language-python">"male", "female"</code></td>
                    </tr>
                    <tr>
                        <td>Tipo di cliente</td>
                        <td><code class="language-python">"loyal client", "disloyal client"</code></td>
                    </tr>
                    <tr>
                        <td>L'età del passeggero</td>
                        <td><code class="language-python">Integer</code></td>
                    </tr>
                    <tr>
                        <td>Il tipo di viaggio</td>
                        <td><code class="language-python">"Personal Travel", "Business Travel"</code></td>
                    </tr>
                    <tr>
                        <td>La classe</td>
                        <td><code class="language-python">"Business", "Eco", "Eco Plus"</code></td>
                    </tr>
                    <tr>
                        <td>La distanza del viaggio</td>
                        <td><code class="language-python">Integer</code></td>
                    </tr>
                    <tr>
                        <td>Il livello di soddisfazione del servizio WiFi durante il volo</td>
                        <td><code class="language-python">{1, 2, 3, 4, 5}</code></td>
                    </tr>
                    <tr>
                        <td>Il livello di soddisfazione della convenienza dell'orario di arrivo/partenza</td>
                        <td><code class="language-python">{1, 2, 3, 4, 5}</code></td>
                    </tr>
                    <tr>
                        <td>Il livello di soddisfazione della facilità di prenotazione online</td>
                        <td><code class="language-python">{1, 2, 3, 4, 5}</code></td>
                    </tr>
                    <tr>
                        <td>Il livello di soddisfazione della posizione del gate</td>
                        <td><code class="language-python">{1, 2, 3, 4, 5}</code></td>
                    </tr>
                    <tr>
                        <td>Il livello di soddisfazione della ristorazione</td>
                        <td><code class="language-python">{1, 2, 3, 4, 5}</code></td>
                    </tr>
                    <tr>
                        <td>Il livello di soddisfazione dell'imbarco online</td>
                        <td><code class="language-python">{1, 2, 3, 4, 5}</code></td>
                    </tr>
                    <tr>
                        <td>Il livello di soddisfazione della comodità dei posti a sedere</td>
                        <td><code class="language-python">{1, 2, 3, 4, 5}</code></td>
                    </tr>
                    <tr>
                        <td>Il livello di soddisfazione dell'intrattenimeto durante il viaggio</td>
                        <td><code class="language-python">{1, 2, 3, 4, 5}</code></td>
                    </tr>
                    <tr>
                        <td>Il livello di soddisfazione dei servizi di imbarco</td>
                        <td><code class="language-python">{1, 2, 3, 4, 5}</code></td>
                    </tr>
                    <tr>
                        <td>Il livello di soddisfazione dello spazio per le gambe tra i sedili</td>
                        <td><code class="language-python">{1, 2, 3, 4, 5}</code></td>
                    </tr>
                    <tr>
                        <td>Il livello di soddisfazione del trattamento dei bagagli</td>
                        <td><code class="language-python">{1, 2, 3, 4, 5}</code></td>
                    </tr>
                    <tr>
                        <td>Il livello di soddisfazione dei servizi di check in</td>
                        <td><code class="language-python">{1, 2, 3, 4, 5}</code></td>
                    </tr>
                    <tr>
                        <td>Il livello di soddisfazione dei servizi durante il volo</td>
                        <td><code class="language-python">{1, 2, 3, 4, 5}</code></td>
                    </tr>
                    <tr>
                        <td>Il livello di soddisfazione della pulizia</td>
                        <td><code class="language-python">{1, 2, 3, 4, 5}</code></td>
                    </tr>
                    <tr>
                        <td>Il ritardo della partenza in minuti</td>
                        <td><code class="language-python">Integer</code></td>
                    </tr>
                    <tr>
                        <td>Il ritardo dell'arrivo in minuti</td>
                        <td><code class="language-python">Integer</code></td>
                    </tr>
                    <tr>
                        <td>La soddisfazione</td>
                        <td><code class="language-python">"satisfied", "neutral or dissatisfied"</code></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<div class="mb-3 border-0">
    <h2 id="3_1">3.1) Caricamento del dataset</h2>
    Partiamo in primi dal caricare il nostro dataset.
    <pre class="line-numbers"><code class="language-python">training_data = pd.read_csv("./data/train.csv", index_col=0)
            testing_data = pd.read_csv("./data/test.csv", index_col=0)</code></pre>
    Fatto ciò possiamo stampare il vettore delle colonne del nostro dataset e la relativa lunghezza (in altre parole il
    numero di campi di cui è composta ogni entry del nostro dataset).
    <pre class="line-numbers"><code class="language-python">columns = list(training_data.columns)
print(columns)
print(len(columns))</code></pre>
    <pre><code class="language-plaintext">['id', 'Gender', 'Customer Type', 'Age', 'Type of Travel', 'Class', 'Flight Distance', 'Inflight wifi service', 'Departure/Arrival time convenient', 'Ease of Online booking', 'Gate location', 'Food and drink', 'Online boarding', 'Seat comfort', 'Inflight entertainment', 'On-board service', 'Leg room service', 'Baggage handling', 'Checkin service', 'Inflight service', 'Cleanliness', 'Departure Delay in Minutes', 'Arrival Delay in Minutes', 'satisfaction']
24</code></pre>
    Possiamo inoltre visualizzare le entries in testa sia del dataset di training che di quello di testing.
    <pre class="line-numbers"><code class="language-python">print(f"{str(training_data.head())}")</code></pre>
    <pre><code class="language-plaintext">        id  Gender      Customer Type  Age   Type of Travel     Class   
0   70172    Male     Loyal Customer   13  Personal Travel  Eco Plus  \
1    5047    Male  disloyal Customer   25  Business travel  Business   
2  110028  Female     Loyal Customer   26  Business travel  Business   
3   24026  Female     Loyal Customer   25  Business travel  Business   
4  119299    Male     Loyal Customer   61  Business travel  Business   
        
   Flight Distance  Inflight wifi service  Departure/Arrival time convenient   
0              460                      3                                  4  \
1              235                      3                                  2   
2             1142                      2                                  2   
3              562                      2                                  5   
4              214                      3                                  3   
        
   Ease of Online booking  ...  Inflight entertainment  On-board service   
0                       3  ...                       5                 4  \
1                       3  ...                       1                 1   
2                       2  ...                       5                 4   
3                       5  ...                       2                 2   
4                       3  ...                       3                 3   
        
   Leg room service  Baggage handling  Checkin service  Inflight service   
0                 3                 4                4                 5  \
1                 5                 3                1                 4   
2                 3                 4                4                 4   
3                 5                 3                1                 4   
4                 4                 4                3                 3   
        
   Cleanliness  Departure Delay in Minutes  Arrival Delay in Minutes   
0            5                          25                      18.0  \
1            1                           1                       6.0   
2            5                           0                       0.0   
3            2                          11                       9.0   
4            3                           0                       0.0   
        
              satisfaction  
0  neutral or dissatisfied  
1  neutral or dissatisfied  
2                satisfied  
3  neutral or dissatisfied  
4                satisfied  

[5 rows x 24 columns]</code></pre>
    <pre class="line-numbers"><code class="language-python">print(f"{str(testing_data.head())}")</code></pre>
    <pre><code class="language-plaintext">      id  Gender      Customer Type  Age   Type of Travel     Class   
0  19556  Female     Loyal Customer   52  Business travel       Eco  \
1  90035  Female     Loyal Customer   36  Business travel  Business   
2  12360    Male  disloyal Customer   20  Business travel       Eco   
3  77959    Male     Loyal Customer   44  Business travel  Business   
4  36875  Female     Loyal Customer   49  Business travel       Eco   

   Flight Distance  Inflight wifi service  Departure/Arrival time convenient   
0              160                      5                                  4  \
1             2863                      1                                  1   
2              192                      2                                  0   
3             3377                      0                                  0   
4             1182                      2                                  3   

   Ease of Online booking  ...  Inflight entertainment  On-board service   
0                       3  ...                       5                 5  \
1                       3  ...                       4                 4   
2                       2  ...                       2                 4   
3                       0  ...                       1                 1   
4                       4  ...                       2                 2   

   Leg room service  Baggage handling  Checkin service  Inflight service   
0                 5                 5                2                 5  \
1                 4                 4                3                 4   
2                 1                 3                2                 2   
3                 1                 1                3                 1   
4                 2                 2                4                 2   

   Cleanliness  Departure Delay in Minutes  Arrival Delay in Minutes   
0            5                          50                      44.0  \
1            5                           0                       0.0   
2            2                           0                       0.0   
3            4                           0                       6.0   
4            4                           0                      20.0   

              satisfaction  
0                satisfied  
1                satisfied  
2  neutral or dissatisfied  
3                satisfied  
4                satisfied  

[5 rows x 24 columns]</code></pre>
    Oltre a ciò possiamo anche stampare il numero di entries totali nel dataset di training e di testing.
    <pre class="line-numbers"><code class="language-python">print(f"Numero di entries nel training dataset: {training_data.shape[0]}")
print(f"Numero di entries nel testing dataset: {testing_data.shape[0]}")</code></pre>
    <pre><code class="language-plaintext">Numero di entries nel training dataset: 103904
        Numero di entries nel testing dataset: 25976</code></pre>        
</div>

<div class="mb-3 border-0">
    <h2 id="3_2">3.2) Caricamento del dataset</h2>
    Alcuni dei dati presenti nel nostro dataset sono sottoforma di stringa, il che rende complicato utilizzarli, in particolare quando dovremo lavorare con vari sistemi di machine learning, pertanto è utile effettuare una trasformazione in modo da potervici lavorare; le sostituzioni seguiranno le seguenti regole:
    <ul>
        <li>
            L'informazione riguardante il sesso viene convertita secondo questa regola: 
            <ul>
                <li><code class="language-python">'Male'=0</code></li>
                <li><code class="language-python">'Female'=1</code></li>
            </ul>
        </li>
            L'informazione riguardante il tipo di cliente viene convertita secondo questa regola:: 
            <ul>
                <li><code class="language-python">'disloyal Customer'=1`</code></li>
                <li><code class="language-python">'Loyal Customer'=0`</code></li>
            </ul>
        </li>
        <li>
            L'informazione riguardante il tipo di viaggio viene convertita secondo questa regola:  
            <ul>
                <li><code class="language-python">'Personal Travel'=1`</code></li>
                <li><code class="language-python">'Business Travel'=0`</code></li>
            </ul>
        </li>
        <li>
            L'informazione riguardante la classe viene convertita secondo questa regola:
            <ul>
                <li><code class="language-python">'Business'=2</code></li>
                <li><code class="language-python">'Eco'=1</code></li>
                <li><code class="language-python">'Eco Plus'=0</code></li>
            </ul>
        </li>
        <li>
            L'informazione riguardante la soddisfazione viene convertita secondo questa regola:
            <ul>
                <li><code class="language-python">'satisfied'=1</code></li>
                <li><code class="language-python">'neutral or dissatisfied'=0</code></li>
            </ul>
        </li>
    </ul>
    <pre class="line-numbers"><code class="language-python">def gender(value):
    if value == 'Male': return 0
    else: return 1

def customer_type(value):
    if value == 'disloyal Customer': return 1
    else: return 0

def type_of_travel(value):
    if value == 'Personal Travel': return 0
    else: return 1

def travel_class(value):
    if value == 'Business': return 2
    elif value == 'Eco': return 1
    else: return 0

def satisfaction(value):
    if value == 'neutral or dissatisfied': return 0
    else: return 1

training_data['Gender'] = training_data['Gender'].apply(gender)
training_data['Customer Type'] = training_data['Customer Type'].apply(customer_type)
training_data['Type of Travel'] = training_data['Type of Travel'].apply(type_of_travel)
training_data['Class'] = training_data['Class'].apply(travel_class)
training_data['satisfaction'] = training_data['satisfaction'].apply(satisfaction)

testing_data['Gender'] = testing_data['Gender'].apply(gender)
testing_data['Customer Type'] = testing_data['Customer Type'].apply(customer_type)
testing_data['Type of Travel'] = testing_data['Type of Travel'].apply(type_of_travel)
testing_data['Class'] = testing_data['Class'].apply(travel_class)
testing_data['satisfaction'] = testing_data['satisfaction'].apply(satisfaction)</code></pre>
</div>

<div class="mb-3 border-0">
    <h2 id="3_3">3.3) Heatmap</h2>
    Ora che abbiamo rielabolato i dato in modo da renderli più "maneggevoli", possiamo iniziare la nostra analisi dei dati. Una prima cosa che possiamo provare a fare è vedere se la correlazione tra le varie informazioni presenta un qualche tipo di rilevanza; questo è possibile tramite una heatmap della correlazione a coppie dei vari valori del dataset:
    <pre class="line-numbers"><code class="language-python">fig, ax = plt.subplots(figsize=(20,10))
sns.heatmap(training_data.corr(), annot=True, fmt='.2f').set_title('Correlazione')</code></pre>
    <img src="img/Compagnia_Aerea/Heatmap.png" width="100%">
</div>